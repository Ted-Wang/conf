[git][git frequently used commands][git/cheatsheet][git cheatsheet]

# From the docs of git diff, --staged is a synonym of --cached

git init
git init prjDir                 ----指定初始仓库的名字，并创建对应目录
git init --bare prjDir.git      ----创建一个初始仓库（中心仓库），这个仓储不会有工作目录，通常用于在服务器上创建一个裸仓库。

git status
git add *                       ----不包括删除的文件，也不包括.开头的文件
git add .                       ----当前目录及其子目录的所有文件，包括.开头的文件，也包括删除的文件。
git add -A                      ----当前库的所有文件，如果pwd在子目录，parents 目录的修改也包括，也包括删除的文件。
git commit -m "message"
git commit -am "message"        ----以上2步合成一步，但是注意，这样只提交“修改过的文件，包括删除的”，新添加的文件，没有被tracked，必须用 git add
git commit -a                   ----使用-a可以查看有哪些文件会被提交，不填message即可取消提交，相当于dry run
git commit --amend							----合并修改，并且弹出 message 编辑器，可以修改上次的 message
git commit --amend -m "Fixes bug #43"		----合并修改，并且添加 message
git commit --amend --no-edit				----合并修改，但是不修改 message
并修改最后一个commit，相当于把index区域的内容和最后一个commit合并，并修改message。
注意：要先 git add *，否则工作区的内容是不会被提交的。
git checkout <tag_name>
git checkout master             ----从 tag 回到 mainline 最新的 commit
git checkout -- <filename>      ----回滚一个文件
git show                        ----show diff of last commit。show 可以指定各种对象，显示内容大不相同。
git show <tag>
删库：1）删除.git目录，2）删除整个 project 目录(就是包含.git目录的那个目录)
	rm -rf .git
	cd .. && rm -rf projectDir

git mv <old_name> <new_name>    ----rename，重命名，不同于直接 mv，这是能在 git status 里追踪到的
git rm <file_name>              ----从 stage 区域删除文件（同时删除工作区中的文件）。
                                    ----如果是用 rm 删除了文件，可以选择：1）执行 git rm 或者 git add <file>，把删除操作推送到stage区，然后再commit。2）git commit -am "message"
git rm -r mydir                 ----删除目录
git rm -r --cached mydir        ----仅仅从 stage area 删除文件（工作区保留）

git restore --staged <file>     ----撤销 git rm 的删除
git checkout -- <file>          ----撤销 rm 删除的文件(刷先从工作获取文件，没有则从版本库更新文件，会丢失没有提交的修改)
git reset HEAD -- <file>        ----从版本库获取文件，覆盖 index 区，工作区保留。--hard，同时覆盖工作区。
git reset HEAD~1                ----undo 最后一次 commit
git reset HEAD                  ----undo git add *，相当于 git reset？
git reset HEAD --hard           ----undo，并且同时修改当前工作区

git reflog                      ----显示 HEAD 的变化历史，可以找到上一次 HEAD 指向的 commit，再次使用 reset 命令恢复

git log -3
git log origin/master           ----git fetch 以后，可以看到 master 和 origin/master 之间差了多少个 commits。
git log --oneline --decorate    ----#oneline 只显示 hash 和 message，decorate 会同时显示所有 references (e.g., branches, tags, etc)
git log --stat                  ----显示每个 commit 增加了多少行，删除了多少行(修改一行会被显示 增加1行+删除1行)
git log -p                      ----显示每个 commit 具体的修改内容
git log --author="<pattern>"    ----搜索指定作者的commit. <pattern>可以是正则表达式.
git log -S"Hello, World!"       ----display commits by content
git log -- <file1 file2>        ----只显示指定文件的 commits.
git shortlog -n                 ----按 author name 分组统计显示每个 user 的 commits。 默认按 author name 排序，-n 是按 commits 数量排序

git log --oneline --graph --decorate --all  ----show graphical commit history
gitk                            ----pop up a window showing commit graph. The command needs to be installed separately.
gitk --all                      ----参数可以替换成 branch name. Git-bash 自带了这个图形化工具。 

git tag
git tag -l 'v1.4.2.*'
git tag -a v1.4 -m 'my version 1.4'
git show v1.4
git tag `date "+%Y-%m-%d_%H-%M-%S"`
git tag -d <tagname>      ----删除一个tag

git branch
git branch -v
git branch -vv            ----查看当前分支以及上游分支
git branch dev            ----创建分支
git checkout -b dev       ----创建并切换到dev分支
git checkout master
git switch -c dev         ----新版本的Git提供了新的git switch命令来切换分支
git merge dev
git branch -d dev test    ----删除本地分支dev、test（没有merged的分支无法删除）
git branch -d -r origin/todo origin/html origin/man       ----删除远程分支todo、html、man
git branch -D dev         ----强行删除分支（包括没有merged的分支），Shortcut for --delete --force.

git fetch origin master
git log --oneline origin/master
git log -p master..origin/master
git stash
git merge origin/master
git stash pop

git remote -v
git remote set-url origin <url>
git remote set-url --add origin <2nd_url>       ----给 origin 添加多个 url，这样就可以同时 push 到多个仓库
git remote add <name> <url>
git remote rm <name>
git remote rename <old-name> <new-name>

git fetch               ----从远程获取最新版本到本地，但不会自动merge。
git fetch --dry-run -v  ----查看有多少更新
git pull                ----可以认为是git fetch和git merge两个步骤的结合。
git fetch <远程主机名> <分支名>
	git fetch origin master	    ----如果是裸仓库，没有origin，可以先 git remote add origin <url>
git pull <远程主机名> <远程分支名>:<本地分支名>
	git pull origin master		----通常本都是省略本地分支名，表示合并同名分支
* 如果 git pull 发生冲突(conflicts)，解决冲突之后要 git add conflict_file，然后 commit

git push <远程主机名> <本地分支名>:<远程分支名>
	git push --dry-run          ----查看结果，不做真实推送。
	git push origin master
	git push origin --tags		----git默认不会push tags

git config --global/system/local -l
git config --global -e
git config --global core.editor <editor>
git config --global core.editor "vim"
git config --global user.name <name>
git config --global user.email <email>

system config file: <git-root>/mingw64/etc/gitconfig
	$(prefix)/etc/gitconfig	----Linux
global config file: %homepath%/.gitconfig
local config file: <repo>/.git/config

git config命令		--system，--global，--local(默认写入)和--file <filename>
https://www.yiibai.com/git/git_config.html
读取时，默认情况下从系统，全局和存储库本地配置文件读取这些值，而选项--system，--global，--local和--file <filename>可用于告知命令从只有那个位置设置和读取。
写入时，默认情况下将新值写入存储库本地配置文件，并且可以使用选项--system，--global，--file <filename>来告诉命令写入该位置(可以指定为 --local，但这是默认值)。

git stash
git stash list
git stash pop               ----恢复最新的进度到工作区。git默认会把工作区和暂存区的改动都恢复到工作区。
git stash pop --index       ----恢复最新的进度到工作区和暂存区。（尝试将原来暂存区的改动还恢复到暂存区）
git stash pop stash@{1}     ----恢复指定的进度到工作区。stash_id是通过git stash list命令得到的
git stash apply [–index] [stash_id]	----除了不删除恢复的进度之外，其余和git stash pop 命令一样。
git stash drop [stash_id]	----删除一个存储的进度。如果不指定stash_id，则默认删除最新的存储进度。
git stash clear	            ----删除所有存储的进度。

git diff                    ----此命令比较的是工作目录(Working tree)和暂存区域快照(index)之间的差异，也就是修改之后还没有 staging 起来的变化内容。
git diff --cached   	    ----比较索引和最后一次 commit 之间的变化; 查看已经 add ，但没有 commit 的改动。
git diff HEAD       	    ----自上次提交以来工作树中的更改；包括工作区和已经staged的修改。如果运行“git commit -a”，查看将会提交什么(不填message会取消提交)。
git diff HEAD^ HEAD^^       ----比较上次提交和上上次提交
git diff --stat             ----显示两个版本差异的统计信息
git config --global diff.tool winmerge/vimdiff		    # 配置 diff.tool，保证 winmerge/diff 的可执行文件在path中。主要的几种diff工具，git会自动配置。“mingw64\libexec\git-core\mergetools”
git config --global difftool.prompt false				# 取消 difftool 的确认提示
配置好之后，使用 git difftool 命令代替 git diff 即可

一文告诉你如何导出 Git 变更文件 https://zhuanlan.zhihu.com/p/74796130
方法1，使用 git 自带命令 git archive, 语法如下。
	git archive -o c:/Users/yourusername/Desktop/export.zip NewCommitId $(git diff --name-only OldCommitId NewCommitId)
	git archive -o c:/Users/yourusername/Desktop/export.zip 479d554cf570edcc28c20ce264c6f216f8223bf3 $(git diff --name-only a838d0512e84e5eb42569cce3ef305d3ac1c44d0 479d554cf570edcc28c20ce264c6f216f8223bf3)
方法2，下载 TortoiseGit Git 客户端软件，使用方法和 svn 的 export 功能类似。


Pro Git book https://git-scm.com/book/zh/v2
Reference https://git-scm.com/docs

【易百教程】Git教程 https://www.yiibai.com/git
【廖雪峰】Git教程 https://www.liaoxuefeng.com/wiki/896043488029600
atlassian 的 git tutorials https://www.atlassian.com/git/tutorials
[译]Atlassian Git系列教程 https://www.cnblogs.com/irocker/p/atlassian-git-tutorials.html


[//]: # ( vim: set syntax=sh: )

